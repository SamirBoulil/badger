{% extends 'GateBundle::base-admin.html.twig' %}

{% block body %}
    <div class="ui basic segment">
        <div class="ui large breadcrumb">
            <a class="section" href="{{ path('admin') }}">Admin</a>
            <div class="divider"> /</div>
            <a class="section" href="{{ path('admin_adventure_index') }}">Adventures</a>
            <div class="divider"> /</div>
            <div class="active section">Pending step claims</div>
        </div>
    </div>

    {% for flash_message in app.session.flashbag.get('notice') %}
        <div class="ui icon positive message">
            <i class="checkmark icon"></i>
            <div class="content">
                <p>{{ flash_message }}</p>
            </div>
        </div>
    {% endfor %}

    {% for flash_message in app.session.flashbag.get('error') %}
        <div class="ui icon error message">
            <i class="warning sign icon"></i>
            <div class="content">
                <p>{{ flash_message }}</p>
            </div>
        </div>
    {% endfor %}

    {% if pendingCompletions is not empty %}
        <table class="ui celled padded table">
            <thead>
            <tr><th class="single line">User</th>
                <th>Step (Adventure)</th>
                <th>Claimed date</th>
                <th>Accept that claim?</th>
            </tr></thead>
            <tbody>
            {% for pendingCompletion in pendingCompletions %}
                <tr>
                    <td>
                        <img class="ui avatar image" src="{{ pendingCompletion.user.profilePicture }}">
                        <span>{{ pendingCompletion.user.username }}</span>
                    </td>
                    <td>
                        <a href="{{ path('admin_adventure_show', { 'id': pendingCompletion.adventureStep.adventure.id }) }}">
                            {{ pendingCompletion.adventureStep.title }} ({{ pendingCompletion.adventureStep.adventure.title }})
                        </a>
                        <p style="margin-top: 10px;">
                            {{ pendingCompletion.adventureStep.description|nl2br }}
                        </p>
                    </td>
                    <td>
                        {{ pendingCompletion.completionDate|date("d/m/Y") }}
                    </td>
                    <td class="center aligned">
                        <div class="ui tiny buttons">
                            <a href="{{ url('admin_claimed_adventure_step_accept', { 'id': pendingCompletion.id }) }}" class="ui positive button">Hell yes!</a>
                            <div class="or"></div>
                            <a href="{{ url('admin_claimed_adventure_step_reject', { 'id': pendingCompletion.id }) }}" class="ui red button">Nope.</a>
                        </div>
                    </td>
                </tr>
            {% endfor %}
            </tbody>
        </table>
    {% else %}
        <div class="ui center aligned padded secondary segment">
            <p><i class="icon thumbs outline up"></i> No claim, no pain.</p>
        </div>
    {% endif %}
{% endblock %}
